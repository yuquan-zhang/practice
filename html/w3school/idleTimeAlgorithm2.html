<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>

<script>
    let idleTimes = [
        {
            "createTime": "2020-11-08 14:56:34",
            "createUserId": "6730783686033146880",
            "endTime": "1970-01-01 12:00:00",
            "id": "6731097046545073152",
            "idleDay": "2020-11-09 00:00:00",
            "startTime": "1970-01-01 09:00:00",
            "updateTime": "2020-11-08 14:56:34",
            "updateUserId": "6730783686033146880",
            "userId": "6730783686033146880"
        },
        {
            "createTime": "2020-11-08 14:56:34",
            "createUserId": "6730783686033146880",
            "endTime": "1970-01-01 20:00:00",
            "id": "6731097046607987712",
            "idleDay": "2020-11-11 00:00:00",
            "startTime": "1970-01-01 13:00:00",
            "updateTime": "2020-11-08 14:56:34",
            "updateUserId": "6730783686033146880",
            "userId": "6730783686033146880"
        },
        {
            "createTime": "2020-11-08 14:56:34",
            "createUserId": "6730783686033146880",
            "endTime": "1970-01-01 20:00:00",
            "id": "6731097046607987712",
            "idleDay": "2020-11-09 00:00:00",
            "startTime": "1970-01-01 13:00:00",
            "updateTime": "2020-11-08 14:56:34",
            "updateUserId": "6730783686033146880",
            "userId": "6730783686033146880"
        }
    ];
    let selectedTimes = [
        {
            "createTime": null,
            "createUserId": null,
            "endTime": "1970-01-01 17:00:00",
            "id": null,
            "idleDay": "2020-11-11 15:00:00",
            "startTime": "1970-01-01 15:00:00",
            "updateTime": null,
            "updateUserId": null,
            "userId": null
        },
        {
            "createTime": null,
            "createUserId": null,
            "endTime": "1970-01-01 17:00:00",
            "id": null,
            "idleDay": "2020-11-12 15:00:00",
            "startTime": "1970-01-01 15:00:00",
            "updateTime": null,
            "updateUserId": null,
            "userId": null
        }
    ];
    let canSelectTime = {};

    idleTimes.forEach(item => {
        let idleDay = item.idleDay.split(' ')[0];
        let startDate = new Date(item.startTime);
        let endDate = new Date(item.endTime);
        let startHour = startDate.getHours();
        let endHour = endDate.getHours();
        let canSelectHours = canSelectTime[idleDay] || {};
        for (let i = startHour; i <= endHour - 2; i++) {
            canSelectHours[i + ":00"] = true;
        }
        canSelectTime[idleDay] = canSelectHours;
    });
    selectedTimes.forEach(item => {
        let idleDay = item.idleDay.split(' ')[0];
        let startDate = new Date(item.startTime);
        let endDate = new Date(item.endTime);
        let startHour = startDate.getHours();
        let endHour = endDate.getHours();
        let canSelectHours = canSelectTime[idleDay] || {};
        for (let i = startHour - 2; i <= endHour; i++) {
            canSelectHours[i + ":00"] = false;
        }
    });
    console.log(canSelectTime);
</script>
</body>
</html>